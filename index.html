<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Rapid 24/7 Towing ‚Äì {{CITY}}, {{STATE_FULL}} | Call Now</title>
  <meta name="description" content="Instant towing in {{CITY}}, {{STATE_FULL}}. Fast arrival, fair pricing, and real humans. Open 24/7. Tap to call now." />
  <link rel="preconnect" href="https://{s}.tile.openstreetmap.org" crossorigin>
  <style>
    :root {
      --bg:#0B0C10; --card:#11141a; --ink:#F8FAFC; --muted:#94a3b8;
      --accent:#22c55e; --danger:#ef4444; --brand:#06b6d4; --touch:56px;
      --max:860px;
    }
    * { box-sizing:border-box }
    html,body { margin:0; padding:0; background:var(--bg); color:var(--ink); font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif }
    a { color:inherit; text-decoration:none }
    .wrap { max-width:var(--max); margin:0 auto; padding:16px 16px 96px }
    header { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 0 }
    .brand { display:flex; align-items:center; gap:10px }
    .logo { width:40px; height:40px; border-radius:8px; background:linear-gradient(135deg, var(--brand), #22d3ee) }
    .brand h1 { font-size:18px; margin:0; letter-spacing:.2px }
    .badge { font-size:12px; color:var(--muted); }
    .hero { background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,0)); border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:16px; display:grid; gap:10px }
    .eyebrow { font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.12em }
    h2 { font-size:24px; margin:0 0 6px; line-height:1.2 }
    .sub { color:var(--muted); font-size:14px }
    .trust { display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 0 }
    .pill { background:#0f172a; border:1px solid rgba(255,255,255,.08); padding:6px 10px; border-radius:999px; font-size:12px; display:flex; align-items:center; gap:6px }
    .grid { display:grid; gap:12px; margin:16px 0 }
    .card { background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:14px; padding:14px }
    .card h3 { margin:0 0 6px; font-size:16px }
    .list { margin:0; padding:0 0 0 18px; color:var(--ink) }
    .muted { color:var(--muted) }
    .cta-sticky { position:fixed; left:0; right:0; bottom:0; padding:10px; background:linear-gradient(180deg, rgba(11,12,16,0), rgba(11,12,16,.95) 40%  ); z-index:999 }
    .cta { display:flex; gap:10px }
    .btn-call { flex:1; height:var(--touch); border:none; border-radius:12px; font-size:18px; font-weight:700; background:linear-gradient(135deg, #10b981, var(--accent)); color:#001b10; box-shadow:0 6px 18px rgba(16,185,129,.35) }
    .btn-text { display:block; line-height:var(--touch); }
    .btn-ghost { height:var(--touch); border-radius:12px; background:#0f172a; border:1px solid rgba(255,255,255,.08); color:var(--ink); padding:0 14px }
    .kpis { display:flex; gap:10px; flex-wrap:wrap }
    .kpi { flex:1 1 120px; background:#0f172a; border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:10px }
    .kpi b { font-size:18px; display:block }
    #map { height:300px; border-radius:14px; overflow:hidden; border:1px solid rgba(255,255,255,.06) }
    footer { margin:24px 0 140px; color:var(--muted); font-size:12px }
    .sr-only { position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden }
    @media(min-width:700px){ h2{font-size:32px} .hero{grid-template-columns:1.4fr .9fr} #map{height:360px}}
  </style>

  <!-- Leaflet (no API key) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <!-- Lightweight icons -->
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
</head>
<body>
  <a class="sr-only" href="#call">Skip to call button</a>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Rapid 24/7 Towing</h1>
          <div class="badge" id="localTime">Checking your local time‚Ä¶</div>
        </div>
      </div>
      <div class="badge" id="hoursBadge" aria-live="polite">Open 24/7</div>
    </header>

    <section class="hero">
      <div>
        <div class="eyebrow" id="eyebrow">Trusted local towing</div>
        <h2 id="headline">Fast, Reliable Towing in {{CITY}}, {{STATE_FULL}}</h2>
        <p class="sub" id="subcopy">Stuck in {{CITY}}? We‚Äôll dispatch immediately. Average arrival &lt; 30 minutes. Licensed, insured, and standing by.</p>
        <div class="trust">
          <span class="pill">‚≠êÔ∏è 4.9/5 Avg</span>
          <span class="pill">‚è±Ô∏è &lt;30 min ETA</span>
          <span class="pill">üõ°Ô∏è Insured &amp; Vetted</span>
          <span class="pill">üìç ZIP <span id="zipPill">‚Äî</span></span>
        </div>
        <div class="grid">
          <div class="kpis">
            <div class="kpi"><b id="kpiCity">Local</b><span class="muted">Servicing your area now</span></div>
            <div class="kpi"><b>24/7</b><span class="muted">Anytime towing & roadside</span></div>
            <div class="kpi"><b>&lt;30m</b><span class="muted">Typical arrival time</span></div>
          </div>
          <div class="card">
            <h3>What we do in {{CITY}}</h3>
            <ul class="list">
              <li>Emergency towing, light &amp; medium duty</li>
              <li>Jump starts, tire changes, lockouts</li>
              <li>Accident &amp; off-hours recovery</li>
              <li>Flatbed &amp; long-distance (ask for quote)</li>
            </ul>
            <p class="muted" style="margin-top:8px">Serving a <span id="radiusLabel">15</span>-mile radius around your location.</p>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="map" role="img" aria-label="Service area map"></div>
      </div>
    </section>

    <section class="grid" aria-label="Guarantees and social proof">
      <div class="card">
        <h3>Why {{CITY}} drivers choose us</h3>
        <ul class="list">
          <li><b>Real humans.</b> You call, we pick up ‚Äî no endless menus.</li>
          <li><b>Fair, upfront pricing.</b> No surprises when we arrive.</li>
          <li><b>Local pros.</b> We know {{CITY}} roads, ramps, and lots.</li>
          <li><b>Open now.</b> It‚Äôs <span id="timeInline">‚Äî</span> your time ‚Äî we‚Äôre ready.</li>
        </ul>
      </div>
      <div class="card">
        <h3>What to expect</h3>
        <ol class="list">
          <li>Tap call ‚Äî tell us where you are</li>
          <li>We dispatch instantly</li>
          <li>Track ETA by text</li>
          <li>Pay on arrival ‚Äî card or cash</li>
        </ol>
      </div>
    </section>

    <footer>
      <div id="footerCity">Rapid 24/7 Towing ‚Äî {{CITY}}, {{STATE_FULL}}</div>
      <div>¬© <span id="year"></span> rapid247towing.com ‚Ä¢ Licensed &amp; Insured ‚Ä¢ USDOT compliant</div>
    </footer>
  </div>

  <!-- Sticky CTA -->
  <div class="cta-sticky" id="call">
    <div class="wrap" style="padding:0 16px">
      <div class="cta">
        <a id="callBtn" href="tel:+15555551234" aria-label="Call towing now">
          <button class="btn-call"><span class="btn-text" id="callBtnText">Call Towing Now ‚Ä¢ (555) 555-1234</span></button>
        </a>
        <button class="btn-ghost" id="smsBtn" aria-label="Text us">Text</button>
      </div>
    </div>
  </div>

  <!-- Schema: LocalBusiness -->
  <script id="ldjson" type="application/ld+json">{}</script>

  <script>
  (function(){
    // -----------------------------
    // Utilities
    // -----------------------------
    const qs = new URLSearchParams(location.search);
    const pathSlug = decodeURIComponent(location.pathname.replace(/^\/+|\/+$/g,''));
    const stateMap = { AL:"Alabama", AK:"Alaska", AZ:"Arizona", AR:"Arkansas", CA:"California", CO:"Colorado", CT:"Connecticut", DE:"Delaware", FL:"Florida", GA:"Georgia", HI:"Hawaii", ID:"Idaho", IL:"Illinois", IN:"Indiana", IA:"Iowa", KS:"Kansas", KY:"Kentucky", LA:"Louisiana", ME:"Maine", MD:"Maryland", MA:"Massachusetts", MI:"Michigan", MN:"Minnesota", MS:"Mississippi", MO:"Missouri", MT:"Montana", NE:"Nebraska", NV:"Nevada", NH:"New Hampshire", NJ:"New Jersey", NM:"New Mexico", NY:"New York", NC:"North Carolina", ND:"North Dakota", OH:"Ohio", OK:"Oklahoma", OR:"Oregon", PA:"Pennsylvania", RI:"Rhode Island", SC:"South Carolina", SD:"South Dakota", TN:"Tennessee", TX:"Texas", UT:"Utah", VT:"Vermont", VA:"Virginia", WA:"Washington", WV:"West Virginia", WI:"Wisconsin", WY:"Wyoming", DC:"District of Columbia" };

    function titleCase(s){ return s.replace(/[-_]+/g,' ').replace(/\b\w/g, m => m.toUpperCase()); }
    function parseCityStateFromSlug(slug){
      // Expect "Nashville-TN" or "san-diego-CA". City may have hyphens.
      if(!slug) return null;
      const parts = slug.split('/');
      const last = parts[parts.length-1];
      const m = last.match(/^(.+)-([A-Za-z]{2})$/);
      if(!m) return null;
      const cityRaw = m[1].replace(/-/g, ' ');
      const city = titleCase(cityRaw);
      const state = m[2].toUpperCase();
      const stateFull = stateMap[state] || state;
      return {city, state, stateFull};
    }

    function setText(id, text){ const el = document.getElementById(id); if(el) el.textContent = text; }
    function getPhone(){ return (qs.get('phone')||'(555) 555-1234').trim(); }
    function getPhoneTel(){ const p = getPhone().replace(/[^\d+]/g,''); return p.startsWith('+')?p:'+'+p; }
    function getRadiusMiles(){ const r= parseFloat(qs.get('radius')||'15'); return isFinite(r)&&r>0?r:15; }
    function getOpenLabel(){ return qs.get('open') || 'Open 24/7'; }

    // -----------------------------
    // 1) Establish target City/State from URL path or query overrides
    // -----------------------------
    let city = qs.get('city');
    let state = qs.get('state')?.toUpperCase();
    let stateFull = state ? (stateMap[state] || state) : undefined;
    if(!city || !state){
      const parsed = parseCityStateFromSlug(pathSlug);
      if(parsed){ city = city || parsed.city; state = state || parsed.state; stateFull = stateFull || parsed.stateFull; }
    }
    // fallback if neither present; filled by IP later, but set temp placeholders
    if(!city){ city = 'Your Area'; }
    if(!state){ state = ''; }
    if(!stateFull){ stateFull = state || ''; }

    // Inject basic copy now (will refine after IP lookup)
    const headline = `${city}, ${stateFull} Rapid Towing`;
    setText('headline', headline);
    setText('subcopy', `Stuck in ${city}? We‚Äôll dispatch immediately. Average arrival < 30 minutes. Licensed, insured, and standing by.`);
    setText('kpiCity', city);
    setText('footerCity', `Rapid 24/7 Towing ‚Äî ${city}, ${stateFull}`);
    document.title = `Rapid 24/7 Towing ‚Äì ${city}, ${stateFull} | Call Now`;

    // Phone + hours
    const phoneHuman = getPhone();
    const phoneTel = 'tel:' + getPhoneTel();
    document.getElementById('callBtn').setAttribute('href', phoneTel);
    setText('callBtnText', `Call Towing Now ‚Ä¢ ${phoneHuman}`);
    setText('hoursBadge', getOpenLabel());

    // Inline year
    setText('year', new Date().getFullYear());

    // -----------------------------
    // 2) IP geolocation (timezone, localtime, lat/lon, postal)
    // Using ipapi.co (no API key, fair-use). Replace with your provider if desired.
    // -----------------------------
    const timeEl = document.getElementById('localTime');
    const timeInlineEl = document.getElementById('timeInline');
    const zipPill = document.getElementById('zipPill');
    const radiusLabel = document.getElementById('radiusLabel');
    const radiusMiles = getRadiusMiles();
    radiusLabel.textContent = radiusMiles;

    function fmtTime(dt){ return dt.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'}); }

    fetch('https://ipapi.co/json/')
      .then(r => r.ok ? r.json() : Promise.reject('ipapi fail'))
      .then(data => {
        const tz = data.timezone || 'UTC';
        const now = new Date();
        const local = new Date(now.toLocaleString('en-US', { timeZone: tz }));
        const hhmm = fmtTime(local);
        const tzShort = (Intl.DateTimeFormat('en-US',{timeZone:tz,timeZoneName:'short'}).format(local)).split(' ').pop();

        setText('localTime', `It‚Äôs ${hhmm} ${tzShort} where you are ‚Äî we‚Äôre open now`);
        setText('timeInline', `${hhmm} ${tzShort}`);

        // ZIP & map
        const lat = parseFloat(data.latitude);
        const lon = parseFloat(data.longitude);
        const postal = (data.postal || '').toString();
        if (postal) setText('zipPill', postal);

        // If city/state were missing, fill from IP
        if(city==='Your Area' && data.city){
          city = data.city; state = data.region_code || state; stateFull = data.region || stateFull;
          // Re-inject
          setText('headline', `${city}, ${stateFull} Rapid Towing`);
          setText('subcopy', `Stuck in ${city}? We‚Äôll dispatch immediately. Average arrival < 30 minutes. Licensed, insured, and standing by.`);
          setText('kpiCity', city);
          setText('footerCity', `Rapid 24/7 Towing ‚Äî ${city}, ${stateFull}`);
          document.title = `Rapid 24/7 Towing ‚Äì ${city}, ${stateFull} | Call Now`;
        }

        initMap(lat, lon, radiusMiles);

        // Schema after we have location
        injectSchema({
          name: "Rapid 24/7 Towing",
          phone: phoneHuman,
          lat, lon, city, state, stateFull, postal
        });
      })
      .catch(_ => {
        setText('localTime', `Open now ‚Äî 24/7`);
        injectSchema({ name:"Rapid 24/7 Towing", phone: phoneHuman, city, state, stateFull });
      });

    // -----------------------------
    // 3) Map + radius (Leaflet + OSM)
    // -----------------------------
    function initMap(lat, lon, radiusMiles){
      try{
        const map = L.map('map', { zoomControl:false, scrollWheelZoom:false, dragging:true }).setView([lat, lon], 12);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 18,
          attribution: '&copy; OpenStreetMap'
        }).addTo(map);

        const meters = radiusMiles * 1609.34;
        L.circle([lat, lon], { radius: meters, color:'#22c55e', weight:2, fill:true, fillOpacity:0.08 }).addTo(map);
        L.marker([lat, lon]).addTo(map).bindPopup(`<b>Your location</b><br/>Within ${radiusMiles} miles service area.`);
      }catch(e){
        const m = document.getElementById('map');
        if(m) m.innerHTML = '<div style="padding:16px">Map unavailable.</div>';
      }
    }

    // -----------------------------
    // 4) SMS click (optional: replace with your SMS number)
    // -----------------------------
    document.getElementById('smsBtn').addEventListener('click', () => {
      const smsNumber = getPhoneTel().replace('tel:','');
      const smsBody = encodeURIComponent(`Hi, I need towing help in ${city}, ${stateFull}. My location is: `);
      location.href = `sms:${smsNumber}?&body=${smsBody}`;
    });

    // -----------------------------
    // 5) Structured data (schema.org)
    // -----------------------------
    function injectSchema({name, phone, lat, lon, city, state, stateFull, postal}){
      const data = {
        "@context":"https://schema.org",
        "@type":"TowingService",
        "name": name,
        "image": "https://rapid247towing.com/logo.png",
        "telephone": phone,
        "url": location.origin + location.pathname,
        "areaServed": {
          "@type":"AdministrativeArea",
          "name": `${city}, ${stateFull}`
        },
        "address": {
          "@type":"PostalAddress",
          "addressLocality": city,
          "addressRegion": state,
          "postalCode": postal || undefined,
          "addressCountry":"US"
        },
        "geo": (lat && lon) ? { "@type":"GeoCoordinates", "latitude": lat, "longitude": lon } : undefined,
        "openingHoursSpecification":[{ "@type":"OpeningHoursSpecification", "dayOfWeek":[ "Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday" ], "opens":"00:00", "closes":"23:59" }],
        "priceRange":"$$",
        "sameAs":[]
      };
      document.getElementById('ldjson').textContent = JSON.stringify(data, null, 2);
    }

    // -----------------------------
    // 6) Minimal GA/Ads hooks (optional)
    // -----------------------------
    // window.dataLayer = window.dataLayer || [];
    // function gtag(){ dataLayer.push(arguments); }
    // gtag('js', new Date());
    // gtag('config', 'G-XXXXXXXX'); // GA4
    // document.getElementById('callBtn').addEventListener('click', ()=> gtag('event','call_click', {city, state}));

  })();
  </script>
</body>
</html>